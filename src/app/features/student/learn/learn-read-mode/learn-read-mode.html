<div class="mb-6">
  <h1 class="text-2xl md:text-3xl font-bold text-slate-900 mb-4">
    {{ topic().title }}
  </h1>

  <div class="flex flex-wrap gap-3">
    <button
      (click)="onReadAloudClick()"
      class="flex items-center px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm text-slate-700 font-medium transition-colors"
    >
      <lucide-icon [img]="icons.Volume2" class="w-4 h-4 mr-2"></lucide-icon>
      Read Aloud
    </button>

    <button
      class="flex items-center px-3 py-1.5 bg-slate-100 hover:bg-slate-200 rounded-lg text-sm text-slate-700 font-medium transition-colors"
      (click)="handleRegenerateClick()"
    >
      <lucide-icon [img]="icons.Sparkles" class="w-4 h-4 mr-2 text-purple-500"></lucide-icon>
      Regenerate with AI
    </button>
  </div>

  <div class="prose prose-slate prose-lg max-w-none grow text-slate-600 leading-relaxed mt-5">
    @for (block of parsedBlocks(); track $index) {
      @switch (block.type) {
        @case ('h3') {
          <h3 class="text-xl font-bold mt-8 mb-3 text-slate-800">{{ block.text }}</h3>
        }

        @case ('callout') {
          <p
            class="my-4 font-semibold text-slate-800 bg-slate-50 p-3 rounded-lg border-l-4 border-indigo-600"
          >
            {{ block.text }}
          </p>
        }

        @case ('spacer') {
          <div class="h-2"></div>
        }

        @case ('p') {
          <p class="mb-4">
            @for (part of block.parts; track $index) {
              @if (part.isBold) {
                <strong class="text-slate-900">{{ part.text }}</strong>
              } @else {
                {{ part.text }}
              }
            }
          </p>
        }
      }
    }
  </div>
</div>
